# ğŸš€ Render Deployment Quick Reference

## One-Page Cheat Sheet

### ğŸ“‹ Pre-Deployment

```bash
# Check everything is ready
./check-deployment.sh

# Commit changes
git add .
git commit -m "Deploy to Render"
git push origin main
```

### ğŸ—„ï¸ Database Setup (Neon)

1. **Create**: [console.neon.tech](https://console.neon.tech) â†’ New Project
2. **Copy**: Connection string (starts with `postgres://`)
3. **Format**: Must include `?sslmode=require` at the end

```
postgres://user:password@ep-xxx.neon.tech/dbname?sslmode=require
```

### ğŸ¯ Deploy to Render

**Method 1: Blueprint (Recommended)**
1. [dashboard.render.com](https://dashboard.render.com) â†’ **New** â†’ **Blueprint**
2. Connect repo: `farhanrafiq/unionrsegistry`
3. Set `DATABASE_URL` â†’ Click **Apply**

**Method 2: Manual**
- Create Web Service for backend (`server/`)
- Create Static Site for frontend (root)
- Configure env vars manually

### ğŸ”‘ Environment Variables

#### Backend (union-registry-api)
```bash
DATABASE_URL=postgres://user:pass@host/db?sslmode=require
JWT_SECRET=<auto-generated or custom>
PORT=10000
NODE_ENV=production
ALLOWED_ORIGINS=*  # Change to frontend URL for production
```

#### Frontend (union-registry-frontend)
```bash
VITE_API_URL=https://union-registry-api.onrender.com
```

âš ï¸ **Important**: After deployment, manually set `VITE_API_URL` to your backend URL!

### âœ… Post-Deployment Setup

1. **Get Backend URL**: Copy from `union-registry-api` service
2. **Set Frontend API**:
   - Go to `union-registry-frontend` â†’ Environment
   - Set `VITE_API_URL` = backend URL
   - Save (auto-redeploys)
3. **Test Health**: `https://your-api.onrender.com/health`

### ğŸŒ± Seed Database (Optional)

**Option A: Manual**
```bash
# In Render Shell (backend service)
npm run seed
```

**Option B: Automatic**
```bash
# Add env var to backend
SEED_DATABASE=true
```

Creates demo dealer: `dealer1` / `Union@2025`

### ğŸ§ª Testing

```bash
# Backend health
curl https://union-registry-api.onrender.com/health

# Frontend
open https://union-registry-frontend.onrender.com

# Full test flow
1. Open frontend
2. Click "Dealer Login"
3. Try "Forgot Password?" â†’ dealer1
4. Check backend logs for email mock
```

### ğŸ”„ Updates & Redeployment

```bash
# Auto-deploy on push
git add .
git commit -m "Update"
git push origin main
# Render auto-deploys in 1-2 minutes
```

### ğŸ› Quick Troubleshooting

| Issue | Solution |
|-------|----------|
| Frontend can't connect | Set `VITE_API_URL` correctly |
| CORS error | Update `ALLOWED_ORIGINS` in backend |
| Backend won't start | Check `DATABASE_URL` format |
| 502 Bad Gateway | Wait 30s (cold start on free tier) |
| DB connection error | Verify `?sslmode=require` in URL |

### ğŸ“Š Service URLs

After deployment, you'll have:
- **Backend**: `https://union-registry-api.onrender.com`
- **Frontend**: `https://union-registry-frontend.onrender.com`
- **Health Check**: `https://union-registry-api.onrender.com/health`

### ğŸ’° Free Tier Limits

- **Neon DB**: 3 GB storage, 10 connections
- **Backend**: 750 hrs/month, sleeps after 15 min
- **Frontend**: 100 GB bandwidth/month
- **Total**: $0/month ğŸ‰

### ğŸ”— Important Links

- **Render Dashboard**: [dashboard.render.com](https://dashboard.render.com)
- **Neon Console**: [console.neon.tech](https://console.neon.tech)
- **Full Guide**: [DEPLOYMENT.md](./DEPLOYMENT.md)
- **Checklist**: [DEPLOYMENT-CHECKLIST.md](./DEPLOYMENT-CHECKLIST.md)
- **Post-Deploy**: [POST-DEPLOYMENT.md](./POST-DEPLOYMENT.md)

### ğŸ¯ Common Commands

```bash
# Local development
npm run dev                    # Frontend
cd server && npm run dev      # Backend

# Build locally
npm run build                 # Frontend
cd server && npm run build    # Backend

# Database
cd server
npm run generate              # Generate Prisma client
npm run migrate              # Run migrations
npm run seed                 # Seed database

# Deployment check
./check-deployment.sh        # Verify everything
```

### ğŸ” Security Checklist

- [ ] `DATABASE_URL` set in Render (not in code)
- [ ] `JWT_SECRET` generated (use Render's auto-generate)
- [ ] `.env` files NOT committed to git
- [ ] `ALLOWED_ORIGINS` restricted (not `*`) for production
- [ ] Custom domain with SSL (free on Render)

### ğŸ“± Mobile/Multi-Device Testing

1. Deploy app
2. Seed database (`npm run seed`)
3. Login on device 1: `dealer1` / `Union@2025`
4. Create an employee
5. Login on device 2 with same credentials
6. Employee should appear âœ…

### ğŸ¨ Custom Domain (Optional)

1. Service â†’ Settings â†’ Custom Domain
2. Add domain: `yourdomain.com`
3. Update DNS records as shown
4. SSL auto-provisioned (free!)
5. Update `VITE_API_URL` and `ALLOWED_ORIGINS`

### ğŸš¨ Emergency Procedures

**Service Down**
1. Check Render status page
2. Review service logs
3. Restart service manually

**Database Issues**
1. Check Neon console
2. Verify connection limit (10 max)
3. Restart backend service

**Deploy Failed**
1. Check build logs
2. Test build locally: `npm run build`
3. Verify all env vars are set
4. Clear build cache in Render

---

## ğŸ“ Learning Path

1. âœ… Read [RENDER-READY.md](./RENDER-READY.md) - Overview
2. âœ… Follow [DEPLOYMENT-CHECKLIST.md](./DEPLOYMENT-CHECKLIST.md) - Deploy
3. âœ… Complete [POST-DEPLOYMENT.md](./POST-DEPLOYMENT.md) - Configure
4. âœ… Reference this file - Quick lookup

---

**Questions?** Check [DEPLOYMENT.md](./DEPLOYMENT.md) for detailed troubleshooting!
